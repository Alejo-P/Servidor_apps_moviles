<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lista de PDFs cargados</title>
    <script src="https://unpkg.com/@tailwindcss/browser@4"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.min.js"></script>
    <style>
        .animate-glow {
            animation: glow 1.5s infinite alternate;
        }

        @keyframes glow {
            from {
                text-shadow: 0 0 10px #fff, 0 0 20px #fff, 0 0 30px #fff, 0 0 40px #0ff, 0 0 70px #0ff, 0 0 80px #0ff, 0 0 100px #0ff, 0 0 150px #0ff;
            }
            to {
                text-shadow: 0 0 5px #fff, 0 0 10px #fff, 0 0 15px #fff, 0 0 20px #0ff, 0 0 35px #0ff, 0 0 40px #0ff, 0 0 50px #0ff, 0 0 75px #0ff;
            }
        }
    </style>
</head>
<body class="bg-gray-800">
    <h1 class="text-4xl text-center text-white font-bold text-slate-800 uppercase bg-green-600 p-4">
        Archivos cargados
    </h1>
    
    <div class="flex flex-col items-center align-center h-full m-4 p-4 border border-gray-300 rounded-lg bg-gray-300">
        <div class="flex flex-col items-center">
            <p id="message" class="text-center font-bold mt-4"></p>
        </div>
    
        <div class="relative overflow-x-auto shadow-lg sm:rounded-lg m-3 p-3 bg-white w-full">
            <table class="border-gray-300 w-full mt-4 rounded-lg border-collapse overflow-hidden">
                <thead class="bg-gray-200">
                    <tr>
                        <th class="rounded-tl-lg border border-gray-300 p-2">Nombre</th>
                        <th class="rounded-tr-lg border border-gray-300 p-2">Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    {% for pdf in files %}
                        <tr>
                            <td class="border border-gray-300 p-2">
                                <p class="text-blue-500 font-bold">
                                    {{ pdf["name"] }}
                                </p>
                            </td>
                            <td class="border border-gray-300 p-2 text-center flex justify-around">
                                <a
                                    class="text-blue-500 font-bold cursor-pointer"
                                    onclick="viewModal(this.getAttribute('data-src'))"
                                    data-src="{{ pdf['name'] }}"
                                >
                                    Ver archivo
                                </a>

                                <a
                                    class="text-green-500 font-bold cursor-pointer"
                                    onclick="generateQR(this.getAttribute('data-name'), this.getAttribute('data-src'))"
                                    data-src="{{ pdf['qr'] }}"
                                    data-name="{{ pdf['name'] }}"
                                >
                                    {% if pdf['qr'] %}
                                        Ver c贸digo QR
                                    {% else %}
                                        Generar c贸digo QR
                                    {% endif %}
                                </a>                                

                                <a
                                    class="text-red-500 font-bold cursor-pointer"
                                    onclick="deletePDF(this.getAttribute('data-name'))"
                                    data-name="{{ pdf['name'] }}"
                                >
                                    Eliminar archivo
                                </a>
                            </td>
                        </tr>
                    {% endfor %}
                    
                    {% if files|length == 0 %}
                        <tr>
                            <td class="border border-gray-300 p-2 text-center" colspan="2">
                                No hay archivos cargados.
                            </td>
                        </tr>
                    {% endif %}
                </tbody>
            </table>        
        </div>
    </div>

    <!-- MODAL PARA VISOR DE ARCHIVOS -->
    <div id="pdfModal" class="fixed inset-0 bg-gray-900 bg-opacity-50 hidden flex items-center justify-center">
        <div class="bg-white p-6 rounded-lg shadow-lg w-3/4 h-3/4 relative overflow-hidden">
            <h2 class="text-2xl text-center text-slate-800 font-bold" id="modalTitle"></h2>
            <!-- Visor para PDFs-->
            <iframe
                id="pdfViewer"
                class="w-full h-[500px] mt-4 hidden"
                src=""
                frameborder="0"
            ></iframe>

            <!-- Visor para imagenes-->
            <img
                id="imageViewer"
                class="w-full h-[500px] mt-4 hidden border rounded-lg border-orange-300 shadow-[0_0_15px_4px_rgba(216,100,75,0.7)]"
                src=""
                alt="Imagen"
            >

            <!-- Visor para textos -->
            <div
                id="textViewer"
                class="w-full h-[500px] mt-4 hidden overflow-auto"
            >
                <span class="text-center text-slate-800 font-bold"></span>
            </div>
        </div>
    </div>

    <!-- MODAL PARA VER EL QR -->
    <div id="qrModal" class="fixed inset-0 bg-gray-900 bg-opacity-50 hidden flex items-center justify-center">
        <div class="bg-white p-6 rounded-lg shadow-lg w-2/4 h-3/4 relative overflow-hidden">
            <h2 class="text-2xl text-center text-slate-800 font-bold">C贸digo QR</h2>
            <img id="qrImage" class="w-full h-[500px] mt-4" src="" alt="C贸digo QR">
        </div>
    </div>

    <a
        id="floatingButton"
        href="/views/upload"
        class="fixed bottom-6 right-6 bg-blue-500 text-white w-14 h-14 flex items-center justify-center rounded-lg shadow-[0_0_15px_4px_rgba(59,130,246,0.7)] hover:shadow-[0_0_25px_6px_rgba(59,130,246,1)] hover:scale-110 transition-transform duration-300 animate-glow"
        title="Subir archivos"
    >
        <span class="text-3xl">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
            </svg>
        </span>
    </a>

    <script src="{{ JSfile }}"></script>
</body>
</html>